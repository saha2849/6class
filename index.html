<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ü¶á –ü–æ—Ä—Ç–∞–ª "–ì–æ—Ç—ç–º" 6 "–ì" –ö–ª–∞—Å—Å (MAX Style)</title>
    <link href="https://fonts.googleapis.com/css2?family=Creepster&family=Orbitron:wght@700&family=Montserrat:wght=400;700&display=swap" rel="stylesheet">
    <style>
        /* --- –û–±—â–∏–µ –°—Ç–∏–ª–∏ –∏ –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ --- */
        :root {
            --primary-orange: #ff4500; /* –ì–ª—É–±–æ–∫–∏–π –æ—Ä–∞–Ω–∂–µ–≤—ã–π */
            --primary-purple: #8a2be2; /* –≠–ª–µ–∫—Ç—Ä–∏—á–µ—Å–∫–∏–π —Ñ–∏–æ–ª–µ—Ç–æ–≤—ã–π */
            --dark-bg: #0a0a0a; /* –ü–æ—á—Ç–∏ —á–µ—Ä–Ω—ã–π, –≥–æ—Ç–∏—á–µ—Å–∫–∏–π —Ñ–æ–Ω */
            --light-text: #e0e0e0;
            --neon-glow: #ff9800; /* –ù–µ–æ–Ω–æ–≤—ã–π –æ—Ä–∞–Ω–∂–µ–≤—ã–π */
        }

        /* --- –ê–ù–ò–ú–ê–¶–ò–ò –§–û–ù–ê (–ù–µ–æ–Ω–æ–≤—ã–µ —Ç—ã–∫–≤—ã) --- */
        @keyframes float {
            0%, 100% { transform: translateY(0) translateX(0) rotate(0deg); opacity: 0.8; }
            50% { transform: translateY(-25px) translateX(15px) rotate(5deg); opacity: 1; }
        }
        .pumpkin-float {
            position: fixed; width: 60px; height: 60px;
            background: radial-gradient(circle, var(--primary-orange) 10%, var(--primary-purple) 90%);
            border-radius: 50% 50% 50% 50% / 60% 60% 40% 40%;
            box-shadow: 0 0 30px var(--primary-orange), 0 0 10px var(--primary-purple) inset; /* –ù–µ–æ–Ω–æ–≤–æ–µ —Å–≤–µ—á–µ–Ω–∏–µ */
            z-index: -1;
            animation: float 12s infinite ease-in-out;
            pointer-events: none;
            filter: blur(0.5px);
        }
        .pumpkin-float:nth-child(1) { left: 10%; top: 15%; animation-delay: 0s; width: 70px; height: 70px; }
        .pumpkin-float:nth-child(2) { left: 80%; top: 30%; animation-delay: 4s; opacity: 0.6; }
        .pumpkin-float:nth-child(3) { left: 30%; bottom: 10%; animation-delay: 8s; width: 50px; height: 50px; }

        /* --- –û–°–ù–û–í–ù–´–ï –≠–õ–ï–ú–ï–ù–¢–´ --- */
        body {
            font-family: 'Montserrat', sans-serif;
            background-color: var(--dark-bg);
            color: var(--light-text);
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            min-height: 100vh; margin: 0; padding: 20px 0; overflow-x: hidden;
        }

        .content-section {
            display: none; padding: 40px; border-radius: 16px;
            background: rgba(10, 10, 10, 0.98);
            /* –£—Å–∏–ª–µ–Ω–Ω—ã–π —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –≥–æ—Ç–∏—á–µ—Å–∫–∏–π —ç—Ñ—Ñ–µ–∫—Ç */
            box-shadow: 0 0 40px rgba(138, 43, 226, 0.5), 0 0 20px var(--primary-orange); 
            max-width: 900px; width: 90%; margin: 20px auto; border: 2px solid var(--primary-purple);
            text-align: center; flex-direction: column; align-items: center; z-index: 10;
        }
        #main-page { display: flex; }

        h1 {
            font-family: 'Creepster', cursive; font-size: 4em; color: var(--primary-orange);
            text-shadow: 0 0 20px var(--neon-glow), 0 0 10px var(--primary-purple);
            letter-spacing: 5px; margin-bottom: 20px;
        }
        
        /* --- –≠–õ–ï–ú–ï–ù–¢–´ –§–û–†–ú: –ü–û–õ–Ø –ò –ö–ù–û–ü–ö–ò (–°–û–í–†–ï–ú–ï–ù–ù–´–ô –î–ò–ó–ê–ô–ù) --- */
        input[type="text"], input[type="password"], .schedule-editor textarea {
            background-color: #1a1a1a;
            color: var(--light-text);
            padding: 14px; /* –£–≤–µ–ª–∏—á–∏–ª–∏ padding –¥–ª—è —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ –≤–∏–¥–∞ */
            margin: 10px 0;
            width: 100%;
            box-sizing: border-box;
            border-radius: 6px;
            border: 1px solid var(--primary-purple); /* –¢–æ–Ω–∫–∞—è —Ä–∞–º–∫–∞ */
            font-size: 1em;
            box-shadow: inset 0 0 5px rgba(0, 0, 0, 0.5);
        }
        input:focus, textarea:focus {
            border-color: var(--primary-orange);
            box-shadow: 0 0 15px rgba(255, 69, 0, 0.6); /* –û—Ä–∞–Ω–∂–µ–≤–æ–µ –Ω–µ–æ–Ω–æ–≤–æ–µ —Å–≤–µ—á–µ–Ω–∏–µ –ø—Ä–∏ —Ñ–æ–∫—É—Å–µ */
            outline: none;
        }

        /* –û–±—â–∏–π —Å—Ç–∏–ª—å –¥–ª—è –≤—Å–µ—Ö –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã—Ö –∫–Ω–æ–ø–æ–∫ */
        .interactive-btn {
            padding: 12px 25px;
            margin-top: 10px;
            border: none;
            border-radius: 6px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.2s ease-in-out;
            font-size: 1.1em;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.5);
            text-transform: uppercase;
        }
        
        /* –ö–Ω–æ–ø–∫–∏ –ì–ª–∞–≤–Ω–æ–π –°–µ—Ç–∫–∏ */
        .action-button { 
            /* –ù–∞—Å–ª–µ–¥—É–µ—Ç .interactive-btn */
            height: 100px; display: flex; flex-direction: column; align-items: center; justify-content: center;
            font-size: 1.1em; color: white; border: none;
        }
        .action-button:hover { transform: scale(1.05); }

        /* –°—Ç–∏–ª–∏–∑–∞—Ü–∏—è –∫–Ω–æ–ø–æ–∫ –ª–æ–≥–∏–Ω–∞, –ø—Ä–æ–≤–µ—Ä–∫–∏ –æ—Ü–µ–Ω–æ–∫, –Ω–∞–∑–∞–¥ */
        #login-section button, #grades-page button, .back-button {
            background-color: var(--primary-purple);
            color: var(--light-text);
        }
        #login-section button:hover, #grades-page button:hover, .back-button:hover {
            background-color: var(--primary-orange);
            color: var(--dark-bg);
            box-shadow: 0 0 20px var(--neon-glow);
            transform: scale(1.02);
        }
        
        /* --- –°—Ç–∏–ª–∏ –¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–≥–æ –ü–µ—Ä–µ—Ä—ã–≤–∞ (–î–ª—è –≤—Å–µ—Ö, –∫—Ä–æ–º–µ –∞–¥–º–∏–Ω–∞) --- */
        #maintenance-page {
            display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(0, 0, 0, 0.98); z-index: 1000; justify-content: center;
            align-items: center; text-align: center; flex-direction: column;
        }
        #maintenance-page h1 { color: #f44336; font-size: 5em; text-shadow: 0 0 20px #f44336; }
        #maintenance-page p { font-size: 1.8em; color: #ff9800; }
    </style>
</head>
<body>
    
    <div class="pumpkin-float"></div>
    <div class="pumpkin-float"></div>
    <div class="pumpkin-float"></div>

    <section id="maintenance-page">
        <h1>üõ†Ô∏è –°–ò–°–¢–ï–ú–ê –û–§–§–õ–ê–ô–ù üõ†Ô∏è</h1>
        <p>
            –ù–∞ –ø–æ—Ä—Ç–∞–ª–µ –ø—Ä–æ–≤–æ–¥—è—Ç—Å—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —Ä–∞–±–æ—Ç—ã.<br>
            –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –±—É–¥–µ—Ç –Ω–∞ –º–µ—Å—Ç–µ, –Ω–æ –¥–ª—è –≤–∞—Å –≤—Ö–æ–¥ –≤—Ä–µ–º–µ–Ω–Ω–æ –∑–∞–∫—Ä—ã—Ç.
        </p>
    </section>

    <section id="main-page" class="content-section">
        <h1>üíÄ –ü–û–†–¢–ê–õ 6 "–ì" –ö–õ–ê–°–°–ê üíÄ</h1>
        <p style="margin-bottom: 40px; color: #aaa;">–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –Ω–∞—à—É –•—ç–ª–ª–æ—É–∏–Ω-–û–±–∏—Ç–µ–ª—å!</p>
        
        <div class="button-grid">
            <button onclick="showSection('roulette-page')" class="action-button interactive-btn" style="background-color: #ff5722;">
                <span class="emoji-icon">üé≤</span> –†—É–ª–µ—Ç–∫–∞ –£–¥–∞—á–∏
            </button>
            <button onclick="showSection('download-page')" class="action-button interactive-btn" style="background-color: #673ab7;">
                <span class="emoji-icon">üìö</span> –°–∫–∞—á–∞—Ç—å –£—á–µ–±–Ω–∏–∫–∏
            </button>
            <button onclick="showSection('schedule-page'); loadScheduleDisplay();" class="action-button interactive-btn" style="background-color: #4caf50;">
                <span class="emoji-icon">üóìÔ∏è</span> –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ
            </button>
            <button onclick="showSection('grades-page')" class="action-button interactive-btn" style="background-color: #ffc107; color: var(--dark-bg);">
                <span class="emoji-icon">‚≠ê</span> –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –û—Ü–µ–Ω–∫–∏ [BETA]
            </button>
            <button onclick="showSection('admin-page'); loadScheduleEditor(); loadRouletteModeDisplay(); loadMaintenanceModeDisplay();" class="action-button interactive-btn" style="background-color: #333; grid-column: span 3; height: 60px;">
                <span class="emoji-icon">üîí</span> –ê–¥–º–∏–Ω: –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –ü–æ—Ä—Ç–∞–ª
            </button>
        </div>
    </section>

    <section id="roulette-page" class="content-section">
        <button onclick="showSection('main-page')" class="back-button interactive-btn">‚Üê –ù–∞ –ì–ª–∞–≤–Ω—É—é</button>
        <h1>üëª –†–£–õ–ï–¢–ö–ê –£–î–ê–ß–ò üëª</h1>
        <div id="roulette-result" style="font-family: 'Orbitron', sans-serif; font-size: 8em; margin: 30px 0; padding: 15px; border: 5px solid #ff0000; border-radius: 15px; background-color: #1a0000; color: var(--neon-glow); text-shadow: 0 0 20px var(--neon-glow), 0 0 40px #ff0000;">?</div>
        <button id="spinButton" class="interactive-btn" style="background-color: var(--primary-orange); color: var(--dark-bg); padding: 15px 30px;">–í–†–ê–©–ê–¢–¨</button>
    </section>
    
    <section id="download-page" class="content-section">
        <button onclick="showSection('main-page')" class="back-button interactive-btn">‚Üê –ù–∞ –ì–ª–∞–≤–Ω—É—é</button>
        <h1>üìö –£–ß–ï–ë–ù–´–ï –ú–ê–¢–ï–†–ò–ê–õ–´</h1>
        
        <div style="margin-top: 50px;">
            <p style="font-size: 2.5em; color: var(--primary-orange); font-family: 'Creepster', cursive; text-shadow: 0 0 10px #ff0000; letter-spacing: 2px;">
                –í–†–ï–ú–ï–ù–ù–û –ù–ï–î–û–°–¢–£–ü–ù–û
            </p>
            <p style="font-size: 1.2em; color: #ccc;">
                –ö–æ–Ω—Ç–µ–Ω—Ç –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –Ω–∞ —Ä–µ—Å—Ç–∞–≤—Ä–∞—Ü–∏–∏. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–π–¥–∏—Ç–µ –ø–æ–∑–∂–µ.
            </p>
        </div>
    </section>

    <section id="schedule-page" class="content-section">
        <button onclick="showSection('main-page')" class="back-button interactive-btn">‚Üê –ù–∞ –ì–ª–∞–≤–Ω—É—é</button>
        <h1>üóìÔ∏è –†–ê–°–ü–ò–°–ê–ù–ò–ï –£–†–û–ö–û–í</h1>
        <div class="schedule-container">
            <p id="schedule-message" style="color: #ff9800;">–ó–∞–≥—Ä—É–∑–∫–∞ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è...</p>
            <div id="schedule-display"></div>
        </div>
    </section>
    
    <section id="grades-page" class="content-section">
        <button onclick="showSection('main-page')" class="back-button interactive-btn">‚Üê –ù–∞ –ì–ª–∞–≤–Ω—É—é</button>
        <h1>‚≠ê –ü–†–û–í–ï–†–ö–ê –û–¶–ï–ù–û–ö [BETA]</h1>
        <p style="margin-bottom: 20px; color: #ccc;">–í–≤–µ–¥–∏—Ç–µ —Å–≤–æ–∏ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏</p>
        
        <div style="width: 100%; max-width: 400px;">
            <input type="text" id="grades-name" placeholder="–§–∞–º–∏–ª–∏—è –∏ –ò–º—è" required>
            <button onclick="checkGrades()" class="interactive-btn">–ü–†–û–í–ï–†–ò–¢–¨</button>
        </div>
        
        <p id="grades-status" style="margin-top: 15px;"></p>
    </section>

    <section id="admin-page" class="content-section">
        <button onclick="showSection('main-page')" class="back-button interactive-btn">‚Üê –ù–∞ –ì–ª–∞–≤–Ω—É—é</button>
        <h1>üîí –ü–ê–ù–ï–õ–¨ –ê–î–ú–ò–ù–ò–°–¢–†–ê–¢–û–†–ê</h1>

        <div id="login-section" style="width: 100%; max-width: 400px;">
            <h2>–í—Ö–æ–¥</h2>
            <div class="login-form">
                <input type="password" id="admin-password" placeholder="–í–≤–µ–¥–∏—Ç–µ —Å–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á">
                <button onclick="login()" class="interactive-btn">–í–æ–π—Ç–∏</button>
            </div>
        </div>

        <div id="editor-section" style="display:none; width: 100%;">
            <hr style="margin: 40px 0; border-color: var(--primary-orange);">
            <h2>üõ†Ô∏è –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –ü–µ—Ä–µ—Ä—ã–≤</h2>
            <div id="maintenance-control">
                <p id="maintenance-mode-status" style="font-size: 1.1em; margin-bottom: 15px;">
                    –¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å: –ó–∞–≥—Ä—É–∑–∫–∞...
                </p>
                <div class="admin-button-group">
                    <button onclick="setMaintenanceMode(true)" class="interactive-btn" style="background-color: #f44336;">
                        üî¥ –í–∫–ª—é—á–∏—Ç—å –ü–µ—Ä–µ—Ä—ã–≤
                    </button>
                    <button onclick="setMaintenanceMode(false)" class="interactive-btn" style="background-color: #4CAF50;">
                        üü¢ –û—Ç–∫–ª—é—á–∏—Ç—å –ü–µ—Ä–µ—Ä—ã–≤
                    </button>
                </div>
            </div>

            <hr class="admin-section-divider">
            <h2>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –†—É–ª–µ—Ç–∫–æ–π</h2>
            <div id="roulette-control">
                <p id="roulette-mode-status" style="font-size: 1.1em; margin-bottom: 15px;">
                    –¢–µ–∫—É—â–∏–π —Ä–µ–∂–∏–º: –ó–∞–≥—Ä—É–∑–∫–∞...
                </p>
                <div class="admin-button-group">
                    <button onclick="setRouletteMode('guaranteed')" class="interactive-btn" style="background-color: var(--primary-orange);">
                        ‚öôÔ∏è –ù–∞–∫—Ä—É—Ç–∏—Ç—å –Ω–∞ "6"
                    </button>
                    <button onclick="setRouletteMode('random')" class="interactive-btn" style="background-color: var(--primary-purple);">
                        üé≤ –°–ª—É—á–∞–π–Ω—ã–π —Ä–µ–∂–∏–º
                    </button>
                </div>
            </div>
            
            <hr class="admin-section-divider">
            <h2>–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ</h2>
            <div class="schedule-editor">
                <label for="mon" style="display: block; text-align: left; margin-top: 10px;">–ü–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫:</label><textarea id="mon" placeholder="1. –ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞, 2. –†—É—Å—Å–∫–∏–π —è–∑—ã–∫..."></textarea>
                <label for="tue" style="display: block; text-align: left;">–í—Ç–æ—Ä–Ω–∏–∫:</label><textarea id="tue" placeholder="1. –§–∏–∑-—Ä–∞, 2. –ò—Å—Ç–æ—Ä–∏—è..."></textarea>
                <label for="wed" style="display: block; text-align: left;">–°—Ä–µ–¥–∞:</label><textarea id="wed" placeholder="1. –ë–∏–æ–ª–æ–≥–∏—è, 2. –ì–µ–æ–≥—Ä–∞—Ñ–∏—è..."></textarea>
                <label for="thu" style="display: block; text-align: left;">–ß–µ—Ç–≤–µ—Ä–≥:</label><textarea id="thu" placeholder="1. –ê–Ω–≥–ª–∏–π—Å–∫–∏–π, 2. –ú—É–∑—ã–∫–∞..."></textarea>
                <label for="fri" style="display: block; text-align: left;">–ü—è—Ç–Ω–∏—Ü–∞:</label><textarea id="fri" placeholder="1. –ò–Ω—Ñ–æ—Ä–º–∞—Ç–∏–∫–∞, 2. –õ–∏—Ç–µ—Ä–∞—Ç—É—Ä–∞..."></textarea>

                <button onclick="saveSchedule()" class="interactive-btn" style="background-color: var(--primary-orange); color: var(--dark-bg); margin-top: 20px;">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ</button>
                <p id="status-message" style="color: var(--primary-orange); margin-top: 15px;"></p>
            </div>
        </div>
    </section>
    
    <script>
        // --- –ì–õ–û–ë–ê–õ–¨–ù–´–ï –ö–û–ù–°–¢–ê–ù–¢–´ –ò –ü–ï–†–ï–ú–ï–ù–ù–´–ï ---
        const ADMIN_PASSWORD = 'admin6g';
        const days = ['–ü–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫', '–í—Ç–æ—Ä–Ω–∏–∫', '–°—Ä–µ–¥–∞', '–ß–µ—Ç–≤–µ—Ä–≥', '–ü—è—Ç–Ω–∏—Ü–∞'];
        const GUARANTEED_NUMBER = 6;
        const min = 1;
        const max = 22;

        // --- 1. –°–ò–°–¢–ï–ú–ê –ü–ï–†–ï–ö–õ–Æ–ß–ï–ù–ò–Ø –°–ï–ö–¶–ò–ô –ò –ü–†–û–í–ï–†–ö–ê –ü–ï–†–ï–†–´–í–ê ---
        function checkMaintenance() {
            const isMaintenanceActive = localStorage.getItem('maintenanceMode') === 'true';
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ –∞–¥–º–∏–Ω–∞
            const isOnAdminPage = document.getElementById('admin-page').style.display === 'flex';
            
            // –ï—Å–ª–∏ –ø–µ—Ä–µ—Ä—ã–≤ –∞–∫—Ç–∏–≤–µ–Ω –ò –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ù–ï –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ –∞–¥–º–∏–Ω–∞ (–ø–æ—Å–ª–µ –≤–≤–æ–¥–∞ –ø–∞—Ä–æ–ª—è)
            if (isMaintenanceActive && !isOnAdminPage) {
                document.querySelectorAll('.content-section').forEach(section => {
                    // –°–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ, –∫—Ä–æ–º–µ —Ç–µ—Ö. —Å—Ç—Ä–∞–Ω–∏—Ü—ã, –∏ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ–º.
                    if (section.id !== 'maintenance-page') {
                        section.style.display = 'none';
                    }
                });
                document.getElementById('maintenance-page').style.display = 'flex';
                document.body.style.overflow = 'hidden';
                return true;
            } else {
                // –ï—Å–ª–∏ –ø–µ—Ä–µ—Ä—ã–≤ –≤—ã–∫–ª—é—á–µ–Ω –∏–ª–∏ —ç—Ç–æ –∞–¥–º–∏–Ω, —Å–∫—Ä—ã–≤–∞–µ–º —Å—Ç—Ä–∞–Ω–∏—Ü—É –ø–µ—Ä–µ—Ä—ã–≤–∞
                document.getElementById('maintenance-page').style.display = 'none';
                document.body.style.overflow = 'auto';
                return false;
            }
        }
        
        function showSection(sectionId) {
            // –ï—Å–ª–∏ –ø–µ—Ä–µ—Ä—ã–≤ –∞–∫—Ç–∏–≤–µ–Ω, –±–ª–æ–∫–∏—Ä—É–µ–º –≤—Å–µ, –∫—Ä–æ–º–µ –∞–¥–º–∏–Ω–∫–∏.
            if (checkMaintenance() && sectionId !== 'admin-page') {
                return;
            }
            
            document.querySelectorAll('.content-section').forEach(section => {
                section.style.display = 'none';
            });
            document.getElementById(sectionId).style.display = 'flex';
            window.scrollTo(0, 0);
        }

        // --- 2. –õ–û–ì–ò–ö–ê –¢–ï–•–ù–ò–ß–ï–°–ö–û–ì–û –ü–ï–†–ï–†–´–í–ê ---
        function setMaintenanceMode(status) {
            localStorage.setItem('maintenanceMode', status);
            loadMaintenanceModeDisplay();
            checkMaintenance(); // –ù–µ–º–µ–¥–ª–µ–Ω–Ω–æ –∞–∫—Ç–∏–≤–∏—Ä—É–µ–º –±–ª–æ–∫–∏—Ä–æ–≤–∫—É
            
            const statusMessage = document.getElementById('status-message');
            const displayStatus = status ? '–í–ö–õ–Æ–ß–ï–ù' : '–û–¢–ö–õ–Æ–ß–ï–ù';
            statusMessage.textContent = `‚úÖ –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –ü–µ—Ä–µ—Ä—ã–≤: ${displayStatus}.`;
            setTimeout(() => { statusMessage.textContent = ''; }, 3000);
        }

        function loadMaintenanceModeDisplay() {
            const isMaintenanceActive = localStorage.getItem('maintenanceMode') === 'true';
            const statusElement = document.getElementById('maintenance-mode-status');
            
            if (isMaintenanceActive) {
                statusElement.textContent = '–¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å: üî¥ –í–ö–õ–Æ–ß–ï–ù';
                statusElement.style.color = '#f44336';
            } else {
                statusElement.textContent = '–¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å: üü¢ –û–¢–ö–õ–Æ–ß–ï–ù';
                statusElement.style.color = '#4CAF50';
            }
        }


        // --- 3. –õ–û–ì–ò–ö–ê –†–£–õ–ï–¢–ö–ò (–û—Å—Ç–∞–ª–∞—Å—å –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π) ---
        const resultDisplay = document.getElementById('roulette-result');
        const spinButton = document.getElementById('spinButton');

        function getRandomInt(min, max) { return Math.floor(Math.random() * (max - min + 1)) + min; }

        function spinRoulette() {
            if (checkMaintenance()) return; // –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞
            spinButton.disabled = true;
            resultDisplay.classList.add('spinning');
            
            let spinIterations = 0;
            const maxSpinIterations = 30;
            const spinIntervalTime = 70;
            const currentMode = localStorage.getItem('rouletteMode') || 'random';

            const spinInterval = setInterval(() => {
                resultDisplay.textContent = getRandomInt(min, max);
                spinIterations++;

                if (spinIterations >= maxSpinIterations) {
                    clearInterval(spinInterval);
                    let finalResult = (currentMode === 'guaranteed') ? GUARANTEED_NUMBER : getRandomInt(min, max);
                    resultDisplay.textContent = finalResult;
                    resultDisplay.classList.remove('spinning');
                    spinButton.disabled = false;
                    resultDisplay.classList.add('number-scroll-animation');
                    setTimeout(() => { resultDisplay.classList.remove('number-scroll-animation'); }, 200);
                }
            }, spinIntervalTime);
        }

        spinButton.addEventListener('click', spinRoulette);


        // --- 4. –õ–û–ì–ò–ö–ê –ê–î–ú–ò–ù–ö–ò ---
        function login() {
            const enteredPassword = document.getElementById('admin-password').value;
            if (enteredPassword === ADMIN_PASSWORD) {
                document.getElementById('login-section').style.display = 'none';
                document.getElementById('editor-section').style.display = 'flex';
                document.getElementById('editor-section').style.flexDirection = 'column';
                loadScheduleEditor();
                loadRouletteModeDisplay();
                loadMaintenanceModeDisplay();
                // –ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –ª–æ–≥–∏–Ω–∞, –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ–º –ø—Ä–æ–≤–µ—Ä–∫—É, —á—Ç–æ–±—ã –∞–¥–º–∏–Ω–∫–∞ –æ—Å—Ç–∞–ª–∞—Å—å –æ—Ç–∫—Ä—ã—Ç–æ–π
                checkMaintenance(); 
            } else {
                alert('‚ùå –ù–µ–≤–µ—Ä–Ω—ã–π —Å–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á!');
                document.getElementById('admin-password').value = '';
            }
        }
        
        function setRouletteMode(mode) {
            localStorage.setItem('rouletteMode', mode);
            loadRouletteModeDisplay();
            const status = document.getElementById('status-message');
            const displayMode = mode === 'guaranteed' ? '–ì–ê–†–ê–ù–¢–ò–†–û–í–ê–ù–û "6"' : '–°–õ–£–ß–ê–ô–ù–´–ô';
            status.textContent = `‚úÖ –†–µ–∂–∏–º —Ä—É–ª–µ—Ç–∫–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –Ω–∞ "${displayMode}".`;
            setTimeout(() => { status.textContent = ''; }, 3000);
        }
        function loadRouletteModeDisplay() {
            const currentMode = localStorage.getItem('rouletteMode') || 'random';
            const statusElement = document.getElementById('roulette-mode-status');
            const displayMode = currentMode === 'guaranteed' ? '–ì–ê–†–ê–ù–¢–ò–†–û–í–ê–ù–û "6"' : '–°–õ–£–ß–ê–ô–ù–´–ô';
            statusElement.textContent = `–¢–µ–∫—É—â–∏–π —Ä–µ–∂–∏–º: ${displayMode}`;
            statusElement.style.color = currentMode === 'guaranteed' ? 'var(--primary-orange)' : '#4caf50';
        }

        function loadScheduleEditor() {
            const storedSchedule = localStorage.getItem('classSchedule');
            if (storedSchedule) {
                const data = JSON.parse(storedSchedule);
                document.getElementById('mon').value = data['–ü–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫'] || '';
                document.getElementById('tue').value = data['–í—Ç–æ—Ä–Ω–∏–∫'] || '';
                document.getElementById('wed').value = data['–°—Ä–µ–¥–∞'] || '';
                document.getElementById('thu').value = data['–ß–µ—Ç–≤–µ—Ä–≥'] || '';
                document.getElementById('fri').value = data['–ü—è—Ç–Ω–∏—Ü–∞'] || '';
            }
        }
        
        function saveSchedule() {
            const scheduleData = {
                '–ü–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫': document.getElementById('mon').value.trim(),
                '–í—Ç–æ—Ä–Ω–∏–∫': document.getElementById('tue').value.trim(),
                '–°—Ä–µ–¥–∞': document.getElementById('wed').value.trim(),
                '–ß–µ—Ç–≤–µ—Ä–≥': document.getElementById('thu').value.trim(),
                '–ü—è—Ç–Ω–∏—Ü–∞': document.getElementById('fri').value.trim()
            };
            localStorage.setItem('classSchedule', JSON.stringify(scheduleData));
            const status = document.getElementById('status-message');
            status.textContent = '‚úÖ –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–æ!';
            setTimeout(() => { status.textContent = ''; }, 3000);
        }

        // --- 5. –û–¢–û–ë–†–ê–ñ–ï–ù–ò–ï –†–ê–°–ü–ò–°–ê–ù–ò–Ø –∏ –û–¶–ï–ù–ö–ò ---
        function loadScheduleDisplay() {
            if (checkMaintenance()) return;
            const scheduleDisplay = document.getElementById('schedule-display');
            const message = document.getElementById('schedule-message');
            const storedSchedule = localStorage.getItem('classSchedule');
            scheduleDisplay.innerHTML = '';
            message.textContent = '';
            if (storedSchedule) {
                const scheduleData = JSON.parse(storedSchedule);
                days.forEach(day => {
                    const dayData = scheduleData[day] || '';
                    const dayDiv = document.createElement('div');
                    let html = `<h3>${day}</h3>`;
                    if (dayData.trim() !== '') {
                        html += `<p>${dayData}</p>`; 
                    } else {
                        html += `<p style="color: #aaa;">–£—Ä–æ–∫–∏ –ø–æ–∫–∞ –Ω–µ –¥–æ–±–∞–≤–ª–µ–Ω—ã.</p>`;
                    }
                    dayDiv.innerHTML = html;
                    scheduleDisplay.appendChild(dayDiv);
                });
            } else {
                message.textContent = '‚ùå –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ –µ—â–µ –Ω–µ –∑–∞–ø–æ–ª–Ω–µ–Ω–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º.';
            }
        }
        
        function checkGrades() {
            if (checkMaintenance()) return; // –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞
            const name = document.getElementById('grades-name').value.trim();
            const status = document.getElementById('grades-status');
            status.style.color = '#ff9800';

            if (name === '') {
                status.textContent = '–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ —Å–≤–æ—é –§–∞–º–∏–ª–∏—é –∏ –ò–º—è.';
                return;
            }
            status.textContent = '–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ —Å–µ—Ä–≤–µ—Ä—É –æ—Ü–µ–Ω–æ–∫... (–ò–¥–µ—Ç –∑–∞–≥—Ä—É–∑–∫–∞ 10 —Å–µ–∫—É–Ω–¥)';
            
            setTimeout(() => {
                status.textContent = `‚ö†Ô∏è –ù–ï–ò–ó–í–ï–°–¢–ù–ê–Ø –û–®–ò–ë–ö–ê. –ü–û–í–¢–û–†–ò–¢–ï –ü–û–ó–ñ–ï. (–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: ${name})`;
                status.style.color = '#ff0000';
            }, 10000);
        }


        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        document.addEventListener('DOMContentLoaded', () => {
             // –°–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–≤–µ—Ä—è–µ–º —Ç–µ—Ö. –ø–µ—Ä–µ—Ä—ã–≤, –ø–æ—Ç–æ–º –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —á—Ç–æ –Ω—É–∂–Ω–æ
             if (!checkMaintenance()) {
                 document.getElementById('main-page').style.display = 'flex';
             }
        });
        
    </script>
</body>
</html>
